---
title: "R Notebook"
output: html_notebook
---

# Load libraries
```{r}
library(tidyverse)
```

# Load csv
```{r}
sf_rent_df <- read_csv("sf_clean.csv") %>% 
  drop_na() %>% 
print(sf_rent_df)
```

# Create parking and prices data frame
This data frame will not be sorted by number of bedrooms. 
```{r}
simplified_df <- sf_rent_df %>% select(price, parking)
print(simplified_df)
```

# descriptive stats by type of parking 
using these descriptive stats, i was able to view mean median and mode rent prices within each parking category 

# Create data frames based on price for each parking category 
```{r}
valet_df <- simplified_df %>% filter(parking == "(a) valet")
protected_df <- simplified_df %>% filter(parking == "(b) protected")
off_street_df <- simplified_df %>% filter(parking == "(c) off-street")
no_parking_df <- simplified_df %>% filter(parking == "(d) no parking")

summary(valet_df)
summary(protected_df)
summary(off_street_df)
summary(no_parking_df)
```

## comparing average rent price across the parking categories 
```{r}
summary_parking_df <- simplified_df %>%
  group_by(parking) %>%
  summarise(mean_price = mean(price, na.rm = TRUE))
```

## create a bar graph displaying the average rent prices in each parking category 
```{r}
ggplot(summary_parking_df, aes(x = parking, y = mean_price, fill = parking)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("red", "hotpink", "purple", "blue")) +
  labs(title = "Average Price for 1 bed by Parking",
       x = "Parking",
       y = "Average Price") +
  theme_minimal()
```

# Inferential Statistics 
## Create linear regression for parking and price
technique: Gaussian linear regression which is non-parametric and does not assume normal distribution 
null Hypothesis: parking has no effect on price 
alternative hypothesis: price is affected by parking availability 
```{r}
glm(formula = price ~ parking , family = gaussian, data = simplified_df) %>%
  summary()
```
## confidence intervals 
```{r}

# Fit model
model <- glm(price ~ parking, family = gaussian, data = simplified_df)

# 95% Confidence intervals for the model coefficients
confint(model)

# Load necessary libraries
library(ggplot2)
library(broom)

# Fit model
model <- glm(price ~ parking, family = gaussian, data = simplified_df)

# Tidy model output and add confidence intervals
coef_df <- tidy(model, conf.int = TRUE)

# Plot coefficients with 95% confidence intervals
ggplot(coef_df, aes(x = term, y = estimate)) +
  geom_col(fill = "red", "hotpink", "purple", "blue", width = 0.6) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = "black") +
  labs(
    title = "Model Coefficients with 95% Confidence Intervals",
    x = "Model Term",
    y = "Coefficient Estimate"
  ) +
  theme_minimal()

```
## bar plot
```{r}

# Tidy model output and add confidence intervals
coef_df <- tidy(model, conf.int = TRUE)

# Plot coefficients with 95% confidence intervals
ggplot(coef_df, aes(x = term, y = estimate)) +
  geom_col(fill = "skyblue", width = 0.6) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = "black") +
  labs(
    title = "Model Coefficients with 95% Confidence Intervals",
    x = "Model Term",
    y = "Coefficient Estimate"
  ) +
  theme_minimal()

```

